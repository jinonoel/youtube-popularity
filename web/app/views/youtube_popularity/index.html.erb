<form id="yt_form" action="youtube_popularity/doAction" method="get">
  Day A:
  <select id="upload_date" name="upload_date">
    <option dayB = "2014-10-17" value="2014-10-07">2014-10-07</option>
    <option dayB = "2014-10-18" value="2014-10-08">2014-10-08</option>
    <option dayB = "2014-10-19" value="2014-10-09">2014-10-09</option>
    <option dayB = "2014-10-20" value="2014-10-10">2014-10-10</option>
<!--
    <option dayB = "2014-10-21" value="2014-10-11">2014-10-11</option>
    <option dayB = "2014-10-22" value="2014-10-12">2014-10-12</option>
    <option dayB = "2014-10-23" value="2014-10-13">2014-10-13</option>
    <option dayB = "2014-10-24" value="2014-10-14">2014-10-14</option>
    <option dayB = "2014-10-25" value="2014-10-15">2014-10-15</option>
    <option dayB = "2014-10-26" value="2014-10-16">2014-10-16</option>
-->
  </select>
  <br>

  Threshold:
  <input type="input" id="threshold">
  <br>

  <div id="buttons">
    <input id="submit_btn" type="button" value="Submit">
    <input id="clear_btn" type="button" value="Clear">
  </div>

  <img id="loading" src="/assets/ajax-loader.gif" style="display:none;">
</form>

<br>

Feature Weights: <span id="weights"></span>

<br>
<br>

<table id="video_table" border="1" style="display:none;">
  <tr>
    <th>Model Rank</th>
    <th>A_view Rank</th>
    <th>B_view Rank</th>
    <th>Video</th>
    <th>Upload Date</th>
    <th id="dayA_col"></th>
    <th id="dayB_col"></th>
    <th>Score</th>
    <th>Features</th>

  </tr>
</table>

<script language="javascript">
  $(document).ready(function() {
    $('#clear_btn').on('click', function() {
      clear_videos();
      $('#weights').html('');
      $('#video_table').hide();
    });

    $('#submit_btn').on('click', function() {
      $('#buttons').hide();
      $('#loading').show();

      jQuery.ajax({
        url : 'youtube_popularity/doAction',
        data : {
          upload_date : $('#upload_date').val(),
          threshold: $('#threshold').val()
        },
        error : function() {
            alert('error!');
        },
        success : function(response) {
            $('#weights').html(response.weights_map);
            $('#video_table').show();
            clear_videos();

            var dayA = $('#upload_date').val();
            var dayB = $("select option:selected").attr("dayB");

            $("#dayA_col").html("No. of views by " + dayA);
            $("#dayB_col").html("No. of views by " + dayB);

            show_videos(response.top_videos);

            $('#buttons').show();
            $('#loading').hide();
        }
      });
    });
  });

  function clear_videos()
  {
    $('.data_row').remove();
  }

  function show_videos(top_videos)
  {
    for (var i = 0; i < top_videos.length; i++) {
      $('#video_table tr:last').after(
        '<tr class=\'data_row\'>'

	+ '<td>' + top_videos[i].model_rank + '</td>'
        + '<td>' + top_videos[i].a_rank + '</td>'
        + '<td>' + top_videos[i].b_rank + '</td>'

        //Orig width 560 height 315
        + '<td><iframe width="420" height="236" src="//www.youtube.com/embed/' + top_videos[i].vid_id + '" frameborder="0" allowfullscreen></iframe></td>'

        + '<td>' + top_videos[i].upload_date + '</td>'
	//+ '<td>' + top_videos[i].score + '</td>'
        + '<td>' + top_videos[i].a_views + '</td>'
        + '<td>' + top_videos[i].b_views + '</td>'
	+ '<td>' + top_videos[i].score + '</td>'
        + '<td>' 
        + 'v.mention: ' + top_videos[i].feature_dot['v.mention'] + '<br>'
        + 'v.hashtag: ' + top_videos[i].feature_dot['v.hashtag'] + '<br>'
        + 'v.rt: ' + top_videos[i].feature_dot['v.rt'] + '<br>'
        + 'v.nbc: ' + top_videos[i].feature_dot['v.nbc'] + '<br>'
        + 'v.tweet: ' + top_videos[i].feature_dot['v.tweet'] + '<br>'
        + 'v.a_views: ' + top_videos[i].feature_dot['v.a_views'] + '<br>'
        + 'u.mention: ' + top_videos[i].feature_dot['u.mention'] + '<br>'
	+ 'u.mention_per_day: ' + top_videos[i].feature_dot['u.mention_per_day'] + '<br>'
        + 'u.hashtag: ' + top_videos[i].feature_dot['u.hashtag'] + '<br>'
        + 'u.hashtag_per_day: ' + top_videos[i].feature_dot['u.hashtag_per_day'] + '<br>'
        + 'u.rt: ' + top_videos[i].feature_dot['u.rt'] + '<br>'
        + 'u.rt_per_day: ' + top_videos[i].feature_dot['u.rt_per_day'] + '<br>'
        + 'u.nbc: ' + top_videos[i].feature_dot['u.nbc'] + '<br>'
        + 'u.nbc_per_day: ' + top_videos[i].feature_dot['u.nbc_per_day'] + '<br>'
        + 'u.tweet: ' + top_videos[i].feature_dot['u.tweet'] + '<br>'
        + 'u.tweet_per_day: ' + top_videos[i].feature_dot['u.tweet_per_day'] + '<br>'

        + 'u.mention_interaction: ' + top_videos[i].feature_dot['u.mention_interaction'] + '<br>'
	+ 'u.mention_interaction_per_day: ' + top_videos[i].feature_dot['u.mention_interaction_per_day'] + '<br>'
        + 'u.hashtag_interaction: ' + top_videos[i].feature_dot['u.hashtag_interaction'] + '<br>'
        + 'u.hashtag_interaction_per_day: ' + top_videos[i].feature_dot['u.hashtag_interaction_per_day'] + '<br>'
        + 'u.rt_interaction: ' + top_videos[i].feature_dot['u.rt_interaction'] + '<br>'
        + 'u.rt_interaction_per_day: ' + top_videos[i].feature_dot['u.rt_interaction_per_day'] + '<br>'
        + 'u.nbc_interaction: ' + top_videos[i].feature_dot['u.nbc_interaction'] + '<br>'
        + 'u.nbc_interaction_per_day: ' + top_videos[i].feature_dot['u.nbc_interaction_per_day'] + '<br>'
        + '</td>'
        + '</tr>'
      );
    }
  }
</script>
