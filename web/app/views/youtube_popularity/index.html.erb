<form id="yt_form" action="youtube_popularity/doAction" method="get">
  Day A:
  <select id="upload_date" name="upload_date">
    <option dayB = "2014-10-17" value="2014-10-07">2014-10-07</option>
    <option dayB = "2014-10-18" value="2014-10-08">2014-10-08</option>
    <option dayB = "2014-10-19" value="2014-10-09">2014-10-09</option>
    <option dayB = "2014-10-20" value="2014-10-10">2014-10-10</option>
    <option dayB = "2014-10-21" value="2014-10-11">2014-10-11</option>
    <option dayB = "2014-10-22" value="2014-10-12">2014-10-12</option>
    <option dayB = "2014-10-23" value="2014-10-13">2014-10-13</option>
    <option dayB = "2014-10-24" value="2014-10-14">2014-10-14</option>
    <option dayB = "2014-10-25" value="2014-10-15">2014-10-15</option>
    <option dayB = "2014-10-26" value="2014-10-16">2014-10-16</option>
  </select>

  <br>

  <div id="buttons">
    <input id="submit_btn" type="button" value="Submit">
    <input id="clear_btn" type="button" value="Clear">
  </div>

  <img id="loading" src="/assets/ajax-loader.gif" style="display:none;">
</form>

<br>

<table id="video_table" border="1" style="display:none;">
  <tr>
    <th>Video</th>
    <th>Upload Date</th>
    <th id="dayA_col"></th>
    <th id="dayB_col"></th>
  </tr>
</table>

<script language="javascript">
  $(document).ready(function() {
    $('#clear_btn').on('click', function() {
      clear_videos();
      $('#video_table').hide();
    });

    $('#submit_btn').on('click', function() {
      $('#buttons').hide();
      $('#loading').show();

      jQuery.ajax({
        url : 'youtube_popularity/doAction',
        data : {
          upload_date : $('#upload_date').val()
        },
        error : function() {
            alert('error!');
        },
        success : function(response) {
            $('#video_table').show();
            clear_videos();

            var dayA = $('#upload_date').val();
            var dayB = $("select option:selected").attr("dayB");

            $("#dayA_col").html("No. of views by " + dayA);
            $("#dayB_col").html("No. of views by " + dayB);

            show_videos(response.top_videos);

            $('#buttons').show();
            $('#loading').hide();
        }
      });
    });
  });

  function clear_videos()
  {
    $('.data_row').remove();
  }

  function show_videos(top_videos)
  {
    for (var i = 0; i < top_videos.length; i++) {
      $('#video_table tr:last').after(
        '<tr class=\'data_row\'>'
	//+ '<td><a href="http://www.youtube.com/watch?v=' + top_videos[i].vid_id + '">' 
        //Orig width 560 height 315
        + '<td><iframe width="420" height="236" src="//www.youtube.com/embed/' + top_videos[i].vid_id + '" frameborder="0" allowfullscreen></iframe></td>'
	//+ top_videos[i].vid_id + '</a></td>'
        + '<td>' + top_videos[i].upload_date + '</td>'
	//+ '<td>' + top_videos[i].score + '</td>'
	//+ '<td>' + top_videos[i].actual + '</td>'
        + '<td>' + top_videos[i].a_views + '</td>'
        + '<td>' + top_videos[i].b_views + '</td>'
        + '</tr>'
      );
    }
  }
</script>
